"0","library('rgdal')"
"0","# Import the VRI data."
"0","vri <- readOGR('../data/external/ska_vri.shp')"
"1","OGR data source with driver:"
"1"," "
"1","ESRI Shapefile"
"1"," "
"1","
"
"1","Source: """
"1","C:\Users\Gwyn\sfuvault\PEEC-talk\data\external\ska_vri.shp"
"1",""", layer: """
"1","ska_vri"
"1",""""
"1","
"
"1","with"
"1"," "
"1","1001"
"1"," "
"1","features"
"1","
"
"1","It has"
"1"," "
"1","188"
"1"," "
"1","fields"
"1","
"
"1","Integer64 fields read as strings: "
"1"," "
"1","POLY_ID REF_YR_ID CRUISE_NO OPEN_ID ORGUNIT_NO LIVE_STEMS DEAD_STEMS PROJ_AGE_1 PROJ_AGE_2"
"1"," "
"1","
"
"0","# Convert to data frame and do some cleaning."
"0","vri.df <- as.data.frame(vri) %>%"
"0","  dplyr::select(treed=BCLCS_LV_2, cover.type=BCLCS_LV_4,"
"0","                density=BCLCS_LV_5, age1=PROJ_AGE_1,"
"0","                age2=PROJ_AGE_2, v.complexity=VERT_COMPL, "
"0","                crown.closure=CR_CLOSURE, live.stems=LIVE_STEMS, "
"0","                basal.area=BASAL_AREA) %>%"
"0","  mutate(live.stems=as.numeric(live.stems), age1=as.numeric(age1),"
"0","         age2=as.numeric(age2))"
"0","# Assume NOGO only roost in forest."
"0","vri.forest <- vri.df %>%"
"0","  filter(treed == 'T') %>%"
"0","  mutate(m.tr.area=basal.area/live.stems,"
"0","         m.age=rowMeans(dplyr::select(., 4:5))) %>%"
"0","  mutate(m.age=case_when(is.na(m.age) ~ as.numeric(age1),"
"0","                         TRUE ~ as.numeric(m.age)))"
